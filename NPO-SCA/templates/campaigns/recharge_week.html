{% extends "base.html" %}
{% block title %}Recharge Week - Campaigns{% endblock %}
{% block styles %}
<style>
  /* Hero section styling with heading accent */
  .rw-hero {
    background: rgba(159, 197, 203, .18);
    padding: 32px;
    border-radius: 18px;
    text-align: center;
    margin-bottom: 26px;
    box-shadow: 0 8px 24px rgba(42, 61, 102, .08)
  }

  .rw-hero h1 {
    margin: 0 0 8px 0;
    font-size: 2.2rem;
    color: var(--deep-indigo);
    position: relative;
    display: inline-block
  }

  .rw-hero h1::after {
    content: "";
    display: block;
    width: 60px;
    height: 3px;
    background: var(--soft-yellow, #F8D29C);
    margin: 12px auto 0;
    border-radius: 2px;
    opacity: 0.7
  }

  .rw-hero p {
    margin: 0;
    color: var(--deep-indigo);
    opacity: .9
  }

  /* Section styling with left accent border and heading underlines */
  .rw-section {
    background: rgba(253, 251, 247, 0.72);
    border-radius: 16px;
    box-shadow: 0 8px 22px rgba(42, 61, 102, .08);
    padding: 22px;
    margin-bottom: 22px;
    border-left: 3px solid var(--soft-yellow)
  }

  .rw-section h2 {
    margin: 0 0 10px 0;
    color: var(--deep-indigo);
    font-size: 1.5rem;
    position: relative;
    display: inline-block
  }

  .rw-section h2::after {
    content: "";
    display: block;
    width: 48px;
    height: 2px;
    background: var(--soft-yellow, #F8D29C);
    margin: 8px 0 0 0;
    border-radius: 1px;
    opacity: 0.65
  }

  .rw-section p {
    color: var(--deep-indigo);
    line-height: 1.85;
    margin: 8px 0
  }

  /* === INTERACTIVE BATTERY SECTION === */
  .battery-section {
    background: #FDFBF7;
    border: 3px solid #2A3D66;
    border-radius: 24px;
    padding: 36px 28px;
    margin-bottom: 26px;
    box-shadow: 6px 6px 0px rgba(42, 61, 102, 0.3), 0 12px 40px rgba(42, 61, 102, 0.12);
    overflow: hidden;
    position: relative;
  }

  .battery-section::before {
    content: '';
    position: absolute;
    inset: 0;
    background: rgba(159, 197, 203, 0.10);
    pointer-events: none;
  }

  .battery-section h2 {
    color: #2A3D66;
    text-align: center;
    font-size: 1.9rem;
    margin-bottom: 8px;
  }

  .battery-section>p {
    color: #4A5A7A;
    text-align: center;
    margin-bottom: 28px;
    font-size: 1.05rem;
  }

  /* Battery Container */
  .battery-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 28px;
  }

  /* Battery Visual */
  .battery-visual {
    position: relative;
    width: 100%;
    max-width: 500px;
  }

  .battery-frame {
    position: relative;
    background: #FFFFFF;
    border: 3px solid #2A3D66;
    border-radius: 20px;
    padding: 12px;
    box-shadow:
      inset 0 2px 8px rgba(42, 61, 102, 0.1),
      4px 4px 0px rgba(42, 61, 102, 0.3),
      0 8px 24px rgba(42, 61, 102, 0.15);
  }

  /* Battery tip */
  .battery-tip {
    position: absolute;
    top: -12px;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 16px;
    background: #9FC5CB;
    border-radius: 6px 6px 0 0;
    border: 3px solid #2A3D66;
    border-bottom: none;
  }

  /* Battery segments container */
  .battery-segments {
    display: flex;
    gap: 8px;
    padding: 8px;
    background: rgba(42, 61, 102, 0.08);
    border-radius: 12px;
  }

  /* Individual segment */
  .battery-segment {
    flex: 1;
    height: 120px;
    background: #E8ECF0;
    border-radius: 8px;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
    border: 2px solid rgba(42, 61, 102, 0.15);
  }

  .battery-segment:hover {
    border-color: #2A3D66;
    transform: translateY(-3px);
    box-shadow: 0 4px 12px rgba(42, 61, 102, 0.2);
  }

  /* Segment fill (the charging animation) */
  .segment-fill {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 0%;
    border-radius: 6px;
    transition: height 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  /* Color variations for each day */
  .battery-segment[data-day="1"] .segment-fill {
    background: #B39CD0;
  }

  .battery-segment[data-day="2"] .segment-fill {
    background: #9FC5CB;
  }

  .battery-segment[data-day="3"] .segment-fill {
    background: #ADCBA4;
  }

  .battery-segment[data-day="4"] .segment-fill {
    background: #F8D29C;
  }

  .battery-segment[data-day="5"] .segment-fill {
    background: #F4D2C8;
  }

  .battery-segment[data-day="6"] .segment-fill {
    background: #8FB8DE;
  }

  .battery-segment[data-day="7"] .segment-fill {
    background: #E8BC6E;
  }

  /* Active/charged state */
  .battery-segment.charged .segment-fill {
    height: 100%;
  }

  /* Glow effect when charged */
  .battery-segment.charged {
    box-shadow: 0 0 20px currentColor;
  }

  .battery-segment[data-day="1"].charged {
    box-shadow: 0 0 25px rgba(155, 123, 184, 0.6);
  }

  .battery-segment[data-day="2"].charged {
    box-shadow: 0 0 25px rgba(135, 206, 235, 0.6);
  }

  .battery-segment[data-day="3"].charged {
    box-shadow: 0 0 25px rgba(152, 216, 170, 0.6);
  }

  .battery-segment[data-day="4"].charged {
    box-shadow: 0 0 25px rgba(255, 217, 61, 0.6);
  }

  .battery-segment[data-day="5"].charged {
    box-shadow: 0 0 25px rgba(255, 159, 159, 0.6);
  }

  .battery-segment[data-day="6"].charged {
    box-shadow: 0 0 25px rgba(168, 216, 234, 0.6);
  }

  .battery-segment[data-day="7"].charged {
    box-shadow: 0 0 25px rgba(244, 208, 111, 0.6);
  }

  /* Day number label */
  .segment-label {
    position: absolute;
    bottom: 8px;
    left: 50%;
    transform: translateX(-50%);
    font-weight: 800;
    font-size: 0.9rem;
    color: rgba(42, 61, 102, 0.5);
    z-index: 2;
    transition: all 0.3s ease;
  }

  .battery-segment.charged .segment-label {
    color: #fff;
    text-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
  }

  /* Energy particles animation */
  @keyframes particle-rise {
    0% {
      transform: translateY(0) scale(1);
      opacity: 0.8;
    }

    100% {
      transform: translateY(-100px) scale(0);
      opacity: 0;
    }
  }

  .energy-particle {
    position: absolute;
    width: 6px;
    height: 6px;
    background: #F4D06F;
    border-radius: 50%;
    pointer-events: none;
    animation: particle-rise 1s ease-out forwards;
  }

  /* Charging animation flash */
  @keyframes segment-flash {

    0%,
    100% {
      opacity: 1;
    }

    50% {
      opacity: 0.6;
    }
  }

  .battery-segment.charging {
    animation: segment-flash 0.3s ease-out;
  }

  /* Percentage display */
  .battery-percentage {
    text-align: center;
    font-size: 2.5rem;
    font-weight: 800;
    color: #2A3D66;
    margin-top: 12px;
    transition: all 0.3s ease;
  }

  .battery-percentage span {
    font-size: 1.2rem;
    color: #5A6A7A;
  }

  /* Day selector buttons (below battery) */
  .day-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin-top: 20px;
  }

  .day-btn {
    background: #fff;
    border: 2px solid rgba(42, 61, 102, 0.2);
    color: #2A3D66;
    padding: 10px 16px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 0.85rem;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .day-btn:hover {
    background: #FDF4C5;
    border-color: #2A3D66;
    transform: translateY(-2px);
    box-shadow: 2px 2px 0px rgba(42, 61, 102, 0.3);
  }

  .day-btn.active {
    background: #F8D29C;
    border-color: #2A3D66;
    color: #2A3D66;
    box-shadow: 3px 3px 0px rgba(42, 61, 102, 0.3);
  }

  /* Content display area */
  .day-content-area {
    width: 100%;
    max-width: 600px;
    margin-top: 24px;
  }

  .day-content {
    display: none;
    background: #fff;
    border: 3px solid #2A3D66;
    border-radius: 16px;
    padding: 24px;
    animation: content-reveal 0.5s ease-out;
    box-shadow: 4px 4px 0px rgba(42, 61, 102, 0.25);
  }

  .day-content.active {
    display: block;
  }

  @keyframes content-reveal {
    0% {
      opacity: 0;
      transform: translateY(20px) scale(0.95);
    }

    100% {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  .day-content h3 {
    color: #2A3D66;
    font-size: 1.4rem;
    margin: 0 0 12px 0;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .day-content h3 .day-icon {
    font-size: 1.8rem;
  }

  .day-content p {
    color: #4A5A7A;
    line-height: 1.7;
    margin: 0;
    font-size: 1.05rem;
  }

  /* Prompt text */
  .battery-prompt {
    text-align: center;
    color: #6B7B8B;
    font-size: 0.95rem;
    margin-top: 16px;
    animation: pulse-text 2s ease-in-out infinite;
  }

  @keyframes pulse-text {

    0%,
    100% {
      opacity: 0.6;
    }

    50% {
      opacity: 1;
    }
  }

  /* Full charge celebration */
  @keyframes celebrate {
    0% {
      transform: scale(1);
    }

    50% {
      transform: scale(1.03);
    }

    100% {
      transform: scale(1);
    }
  }

  .battery-frame.full-charge {
    animation: celebrate 0.5s ease;
    box-shadow:
      inset 0 2px 8px rgba(42, 61, 102, 0.1),
      6px 6px 0px rgba(42, 61, 102, 0.4),
      0 12px 40px rgba(98, 216, 170, 0.3);
  }

  /* Charge All button */
  .charge-all-btn {
    background: #F8D29C;
    border: 3px solid #2A3D66;
    color: #2A3D66;
    padding: 12px 24px;
    border-radius: 50px;
    font-weight: 800;
    font-size: 1rem;
    cursor: pointer;
    margin-top: 16px;
    transition: all 0.3s ease;
    box-shadow: 3px 3px 0px rgba(42, 61, 102, 0.3);
  }

  .charge-all-btn:hover {
    transform: translateY(-3px);
    box-shadow: 3px 6px 0px rgba(42, 61, 102, 0.3), 0 8px 20px rgba(244, 208, 111, 0.3);
  }

  /* Reset button */
  .reset-btn {
    background: transparent;
    border: 2px solid rgba(42, 61, 102, 0.3);
    color: #5A6A7A;
    padding: 8px 16px;
    border-radius: 50px;
    font-weight: 600;
    font-size: 0.85rem;
    cursor: pointer;
    margin-top: 12px;
    transition: all 0.3s ease;
  }

  .reset-btn:hover {
    border-color: #2A3D66;
    color: #2A3D66;
    background: rgba(42, 61, 102, 0.05);
  }

  /* Mobile responsiveness */
  @media (max-width: 600px) {
    .battery-section {
      padding: 20px 16px;
    }

    .battery-segment {
      height: 80px;
    }

    .segment-label {
      font-size: 0.75rem;
    }

    .battery-percentage {
      font-size: 2rem;
    }

    .day-btn {
      padding: 8px 12px;
      font-size: 0.8rem;
    }

    .day-content {
      padding: 18px;
    }

    .day-content h3 {
      font-size: 1.2rem;
    }

    .day-content p {
      font-size: 0.95rem;
    }
  }

  /* Rest of original styles */
  .rw-instagram-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-auto-rows: auto;
    row-gap: 22px;
    column-gap: 16px;
    margin-top: 14px
  }

  .rw-ig-card {
    background: #fff;
    border-radius: 12px;
    padding: 16px;
    box-shadow: 0 6px 16px rgba(42, 61, 102, .08);
    border: 2px solid rgba(42, 61, 102, 0.1)
  }

  .rw-ig-card a.block-link {
    display: block
  }

  .rw-ig-card img {
    width: 100%;
    border-radius: 10px;
    display: block;
    margin-bottom: 8px;
    box-shadow: 0 4px 12px rgba(42, 61, 102, .10)
  }

  .rw-ig-card h3 {
    margin: 0 0 6px 0;
    font-size: 1.05rem;
    color: var(--deep-indigo)
  }

  .rw-ig-card p {
    margin: 0 0 8px 0;
    color: var(--deep-indigo);
    opacity: .9
  }

  .rw-ig-card a {
    font-weight: 600;
    color: var(--gentle-lavender)
  }

  /* Recap Video Card */
  .rw-ig-card.rw-video-card {
    background: #FDF4C5;
    border: 2px solid #2A3D66
  }

  .rw-ig-card.rw-video-card h3 {
    color: #2A3D66;
    font-size: 1.15rem;
    margin-bottom: 10px
  }

  .rw-video-embed {
    width: 100%;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
    background: #000
  }

  .rw-recap-video {
    width: 100%;
    height: auto;
    aspect-ratio: 9/16;
    max-height: 280px;
    object-fit: contain;
    display: block
  }

  @media (max-width:1100px) {
    .rw-instagram-grid {
      grid-template-columns: repeat(2, 1fr)
    }
  }

  @media (max-width:600px) {
    .rw-instagram-grid {
      grid-template-columns: 1fr
    }
  }
</style>
{% endblock %}
{% block content %}
<div class="container">
  <div class="page-container">
    <section class="rw-hero">
      <h1>Recharge Week</h1>
      <p>A 7‑day challenge to reset your mental battery, one mode at a time.</p>
    </section>

    <!-- Wave separator -->
    <div class="wave-separator-subtle"></div>

    <section class="rw-section">
      <h2>What is Recharge Week?</h2>
      <p>This 7‑day series treats your mental energy like a battery that needs tending. Each day focuses on a different
        "mode" - from switching <strong>Sleep Mode ON</strong> for real rest to activating <strong>Airplane
          Mode</strong> for a digital detox - to help you consciously reset. Whether you are decluttering your mind
        during <strong>Clean Storage</strong>, moving your body for a <strong>Fast Charge</strong>, or connecting with
        friends during <strong>Battery Share</strong>, this week offers small, actionable steps to check your energy
        settings and fully power up again.</p>
      <p>Recharge Week is designed to be accessible: you can follow along on social media, participate privately, or
        complete only the days that fit your schedule. The goal is not perfection - it's noticing your needs, creating
        tiny moments of care, and reconnecting with yourself and others.</p>
    </section>

    <!-- Wave separator -->
    <div class="wave-separator"></div>

    <!-- INTERACTIVE BATTERY SECTION -->
    <section class="battery-section">
      <h2>7-Day "Battery Modes"</h2>
      <p>Click each day to charge your battery and reveal the daily challenge!</p>

      <div class="battery-container">
        <!-- Battery Visual -->
        <div class="battery-visual">
          <div class="battery-frame" id="batteryFrame">
            <div class="battery-tip"></div>
            <div class="battery-segments">
              <div class="battery-segment" data-day="1">
                <div class="segment-fill"></div>
                <span class="segment-label">D1</span>
              </div>
              <div class="battery-segment" data-day="2">
                <div class="segment-fill"></div>
                <span class="segment-label">D2</span>
              </div>
              <div class="battery-segment" data-day="3">
                <div class="segment-fill"></div>
                <span class="segment-label">D3</span>
              </div>
              <div class="battery-segment" data-day="4">
                <div class="segment-fill"></div>
                <span class="segment-label">D4</span>
              </div>
              <div class="battery-segment" data-day="5">
                <div class="segment-fill"></div>
                <span class="segment-label">D5</span>
              </div>
              <div class="battery-segment" data-day="6">
                <div class="segment-fill"></div>
                <span class="segment-label">D6</span>
              </div>
              <div class="battery-segment" data-day="7">
                <div class="segment-fill"></div>
                <span class="segment-label">D7</span>
              </div>
            </div>
          </div>
          <div class="battery-percentage"><span id="percentNum">0</span>% <span>Charged</span></div>
        </div>

        <!-- Day selector buttons -->
        <div class="day-buttons">
          <button class="day-btn" data-day="1">Day 1</button>
          <button class="day-btn" data-day="2">Day 2</button>
          <button class="day-btn" data-day="3">Day 3</button>
          <button class="day-btn" data-day="4">Day 4</button>
          <button class="day-btn" data-day="5">Day 5</button>
          <button class="day-btn" data-day="6">Day 6</button>
          <button class="day-btn" data-day="7">Day 7</button>
        </div>

        <button class="charge-all-btn" id="chargeAllBtn">Charge All Days</button>
        <button class="reset-btn" id="resetBtn">Reset Battery</button>

        <!-- Day content display -->
        <div class="day-content-area">
          <div class="day-content" data-day="1">
            <h3>Day 1 - Sleep Mode ON</h3>
            <p>Prioritize real rest by setting a tech cut-off time, softening your evening routine, and giving your body
              permission to power down.</p>
          </div>
          <div class="day-content" data-day="2">
            <h3>Day 2 - Airplane Mode</h3>
            <p>Take a mini digital detox: mute notifications, step away from constant scrolling, and give your mind a
              quiet signal break.</p>
          </div>
          <div class="day-content" data-day="3">
            <h3>Day 3 - Clean Storage</h3>
            <p>Declutter your space or mind - clear a corner of your room, tidy your backpack, or journal out thoughts
              taking up too much storage.</p>
          </div>
          <div class="day-content" data-day="4">
            <h3>Day 4 - Fast Charge</h3>
            <p>Move your body in a way that feels doable: a short walk, stretch break, or dance session to boost energy
              and release stress.</p>
          </div>
          <div class="day-content" data-day="5">
            <h3>Day 5 - Battery Share</h3>
            <p>Connect with someone who fills your cup - send a kind message, join a club event, or simply sit with a
              trusted friend.</p>
          </div>
          <div class="day-content" data-day="6">
            <h3>Day 6 - Quiet Mode</h3>
            <p>Create a calm pocket of time with mindfulness, music, or creative expression so your brain can soften the
              noise of the week.</p>
          </div>
          <div class="day-content" data-day="7">
            <h3>Day 7 - System Check</h3>
            <p>Reflect on what helped you feel more charged, what drained you, and which practices you want to keep as
              part of your routine.</p>
          </div>
          <p class="battery-prompt" id="batteryPrompt">Tap a day to begin charging</p>
        </div>
      </div>
    </section>

    <section class="rw-section">
      <h2>Follow the 7‑Day Series on Instagram</h2>
      <p>You can complete Recharge Week directly from our Instagram posts - each day includes a simple prompt and visual
        reminder.</p>
      <div class="rw-instagram-grid">
        <div class="rw-ig-card">
          <h3>Day 1 - Sleep Mode ON</h3>
          <a href="https://www.instagram.com/p/DQ48vPNgYgL/" target="_blank" rel="noopener" class="block-link">
            <img src="{{ url_for('static', filename='img/RW D1.jpg') }}" alt="Recharge Week Day 1 - Sleep Mode ON">
          </a>
          <p>Kick off the challenge by checking in with your sleep and rest habits.</p>
          <a href="https://www.instagram.com/p/DQ48vPNgYgL/" target="_blank" rel="noopener">View on Instagram</a>
        </div>
        <div class="rw-ig-card">
          <h3>Day 2 - Airplane Mode</h3>
          <a href="https://www.instagram.com/p/DQ7qwCPAb57/" target="_blank" rel="noopener" class="block-link">
            <img src="{{ url_for('static', filename='img/RW D2.jpg') }}" alt="Recharge Week Day 2 - Airplane Mode">
          </a>
          <p>Unplug from constant notifications and give your brain some breathing room.</p>
          <a href="https://www.instagram.com/p/DQ7qwCPAb57/" target="_blank" rel="noopener">View on Instagram</a>
        </div>
        <div class="rw-ig-card">
          <h3>Day 3 - Clean Storage</h3>
          <a href="https://www.instagram.com/p/DQ-OXDdki95/" target="_blank" rel="noopener" class="block-link">
            <img src="{{ url_for('static', filename='img/RW D3.jpg') }}" alt="Recharge Week Day 3 - Clean Storage">
          </a>
          <p>Declutter your space or mind so you have more room for what matters.</p>
          <a href="https://www.instagram.com/p/DQ-OXDdki95/" target="_blank" rel="noopener">View on Instagram</a>
        </div>
        <div class="rw-ig-card">
          <h3>Day 4 - Fast Charge</h3>
          <a href="https://www.instagram.com/p/DRBC5gqjnjq/" target="_blank" rel="noopener" class="block-link">
            <img src="{{ url_for('static', filename='img/RW D4.jpg') }}" alt="Recharge Week Day 4 - Fast Charge">
          </a>
          <p>Recharge through movement - big or small - that feels right for you.</p>
          <a href="https://www.instagram.com/p/DRBC5gqjnjq/" target="_blank" rel="noopener">View on Instagram</a>
        </div>
        <div class="rw-ig-card">
          <h3>Day 5 - Battery Share</h3>
          <a href="https://www.instagram.com/p/DRDiDGwgcsp/" target="_blank" rel="noopener" class="block-link">
            <img src="{{ url_for('static', filename='img/RW D5.jpg') }}" alt="Recharge Week Day 5 - Battery Share">
          </a>
          <p>Share energy by checking in on a friend or joining a supportive space.</p>
          <a href="https://www.instagram.com/p/DRDiDGwgcsp/" target="_blank" rel="noopener">View on Instagram</a>
        </div>
        <div class="rw-ig-card">
          <h3>Day 6 - Quiet Mode</h3>
          <a href="https://www.instagram.com/p/DRFxT61gVMX/" target="_blank" rel="noopener" class="block-link">
            <img src="{{ url_for('static', filename='img/RW D6.jpg') }}" alt="Recharge Week Day 6 - Quiet Mode">
          </a>
          <p>Create calm with mindfulness, journaling, or quiet creative time.</p>
          <a href="https://www.instagram.com/p/DRFxT61gVMX/" target="_blank" rel="noopener">View on Instagram</a>
        </div>
        <div class="rw-ig-card">
          <h3>Day 7 - System Check</h3>
          <a href="https://www.instagram.com/p/DRIhti9ASeb/" target="_blank" rel="noopener" class="block-link">
            <img src="{{ url_for('static', filename='img/RW D7.jpg') }}" alt="Recharge Week Day 7 - System Check">
          </a>
          <p>Reflect on what helped you most and how to carry those habits forward.</p>
          <a href="https://www.instagram.com/p/DRIhti9ASeb/" target="_blank" rel="noopener">View on Instagram</a>
        </div>
        <!-- Recap Video Card -->
        <div class="rw-ig-card rw-video-card">
          <h3>Recharge Week Recap</h3>
          <div class="rw-video-embed">
            <video src="{{ url_for('static', filename='img/RW 1.mp4') }}?v=2" playsinline controls preload="auto"
              controlsList="nodownload" poster="{{ url_for('static', filename='img/RW D1.jpg') }}"
              class="no-save rw-recap-video">
              Your browser does not support the video tag.
            </video>
          </div>
          <p>Watch our full recap video to see how the 7-day challenge came together!</p>
        </div>
      </div>
    </section>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const segments = document.querySelectorAll('.battery-segment');
    const dayBtns = document.querySelectorAll('.day-btn');
    const dayContents = document.querySelectorAll('.day-content');
    const percentNum = document.getElementById('percentNum');
    const batteryFrame = document.getElementById('batteryFrame');
    const batteryPrompt = document.getElementById('batteryPrompt');
    const chargeAllBtn = document.getElementById('chargeAllBtn');
    const resetBtn = document.getElementById('resetBtn');

    let chargedDays = new Set();

    function updatePercentage() {
      const percent = Math.round((chargedDays.size / 7) * 100);
      animateNumber(parseInt(percentNum.textContent), percent, 400);

      if (chargedDays.size === 7) {
        batteryFrame.classList.add('full-charge');
        setTimeout(() => batteryFrame.classList.remove('full-charge'), 500);
      }
    }

    function animateNumber(from, to, duration) {
      const start = performance.now();
      function update(currentTime) {
        const elapsed = currentTime - start;
        const progress = Math.min(elapsed / duration, 1);
        const current = Math.round(from + (to - from) * progress);
        percentNum.textContent = current;
        if (progress < 1) requestAnimationFrame(update);
      }
      requestAnimationFrame(update);
    }

    function createParticles(segment) {
      for (let i = 0; i < 5; i++) {
        const particle = document.createElement('div');
        particle.className = 'energy-particle';
        particle.style.left = Math.random() * 80 + 10 + '%';
        particle.style.bottom = '20%';
        particle.style.animationDelay = Math.random() * 0.3 + 's';
        segment.appendChild(particle);
        setTimeout(() => particle.remove(), 1000);
      }
    }

    function chargeDay(day) {
      const segment = document.querySelector(`.battery-segment[data-day="${day}"]`);
      const btn = document.querySelector(`.day-btn[data-day="${day}"]`);
      const content = document.querySelector(`.day-content[data-day="${day}"]`);

      // Add charging animation
      segment.classList.add('charging');
      setTimeout(() => segment.classList.remove('charging'), 600);

      // Toggle charged state
      if (chargedDays.has(day)) {
        chargedDays.delete(day);
        segment.classList.remove('charged');
        btn.classList.remove('active');
      } else {
        chargedDays.add(day);
        segment.classList.add('charged');
        btn.classList.add('active');
        createParticles(segment);
      }

      // Show content
      dayContents.forEach(c => c.classList.remove('active'));
      content.classList.add('active');
      batteryPrompt.style.display = 'none';

      updatePercentage();
    }

    // Click handlers for segments
    segments.forEach(segment => {
      segment.addEventListener('click', () => {
        const day = segment.dataset.day;
        chargeDay(day);
      });
    });

    // Click handlers for day buttons
    dayBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const day = btn.dataset.day;
        chargeDay(day);
      });
    });

    // Charge all button
    chargeAllBtn.addEventListener('click', () => {
      let delay = 0;
      for (let i = 1; i <= 7; i++) {
        setTimeout(() => {
          if (!chargedDays.has(String(i))) {
            chargeDay(String(i));
          }
        }, delay);
        delay += 200;
      }
    });

    // Reset button
    resetBtn.addEventListener('click', () => {
      chargedDays.clear();
      segments.forEach(s => s.classList.remove('charged'));
      dayBtns.forEach(b => b.classList.remove('active'));
      dayContents.forEach(c => c.classList.remove('active'));
      batteryPrompt.style.display = 'block';
      animateNumber(parseInt(percentNum.textContent), 0, 400);
    });
  });

  // =============================================
  // GSAP ANIMATIONS FOR RECHARGE WEEK - FIXED
  // =============================================
  document.addEventListener('DOMContentLoaded', () => {
    // Ensure all elements are visible first!
    gsap.set('.battery-section, .battery-frame, .battery-tip, .battery-segment, .day-btn, .rw-section, .rw-ig-card', {
      opacity: 1,
      visibility: 'visible',
      scale: 1,
      scaleY: 1,
      x: 0,
      y: 0,
      rotation: 0
    });

    // Hero entrance
    const rwHero = document.querySelector('.rw-hero');
    if (rwHero) {
      gsap.fromTo(rwHero,
        { y: -40, opacity: 0 },
        { y: 0, opacity: 1, duration: 0.6, ease: 'power2.out' }
      );
    }

    // Battery section reveal
    const batterySection = document.querySelector('.battery-section');
    if (batterySection) {
      gsap.fromTo(batterySection,
        { y: 50, opacity: 0 },
        {
          scrollTrigger: { trigger: batterySection, start: 'top 85%' },
          y: 0, opacity: 1, duration: 0.7, ease: 'power2.out'
        }
      );

      // Battery frame
      gsap.fromTo('.battery-frame',
        { y: 30, opacity: 0 },
        {
          scrollTrigger: { trigger: '.battery-frame', start: 'top 88%' },
          y: 0, opacity: 1, duration: 0.5, delay: 0.2, ease: 'power2.out'
        }
      );

      // Battery segments - gentle reveal, NO scaleY!
      const segments = document.querySelectorAll('.battery-segment');
      segments.forEach((seg, i) => {
        gsap.fromTo(seg,
          { y: 20, opacity: 0 },
          {
            scrollTrigger: { trigger: '.battery-segments', start: 'top 88%' },
            y: 0, opacity: 1, duration: 0.4, delay: 0.3 + i * 0.08, ease: 'back.out(1.3)'
          }
        );
      });

      // Day buttons
      const dayBtns = document.querySelectorAll('.day-btn');
      dayBtns.forEach((btn, i) => {
        gsap.fromTo(btn,
          { y: 25, opacity: 0 },
          {
            scrollTrigger: { trigger: '.day-buttons', start: 'top 90%' },
            y: 0, opacity: 1, duration: 0.35, delay: i * 0.06, ease: 'power2.out'
          }
        );
      });
    }

    // Instagram grid cards with variety
    const rwIgCards = document.querySelectorAll('.rw-ig-card');
    rwIgCards.forEach((card, i) => {
      const fromVars = [
        { y: 40, rotation: -3 },
        { y: 45, rotation: 3 },
        { x: -30, rotation: -2 },
        { x: 30, rotation: 2 },
        { scale: 0.9 },
        { y: 50, x: -20 },
        { y: 50, x: 20 },
        { y: 35 }
      ][i % 8];

      gsap.fromTo(card,
        { ...fromVars, opacity: 0 },
        {
          scrollTrigger: { trigger: card, start: 'top 90%' },
          y: 0, x: 0, scale: 1, rotation: 0, opacity: 1,
          duration: 0.5, delay: (i % 4) * 0.08, ease: 'back.out(1.2)'
        }
      );
    });

    // Sections with variety
    const rwSections = document.querySelectorAll('.rw-section');
    const sectionAnims = [
      { x: -50, rotation: -2 },
      { x: 50, rotation: 2 },
      { y: 50 },
      { scale: 0.95, y: 30 }
    ];

    rwSections.forEach((section, i) => {
      const anim = sectionAnims[i % sectionAnims.length];
      gsap.fromTo(section,
        { ...anim, opacity: 0 },
        {
          scrollTrigger: { trigger: section, start: 'top 88%' },
          x: 0, y: 0, scale: 1, rotation: 0, opacity: 1,
          duration: 0.6, ease: 'power2.out'
        }
      );
    });

    // Hover effects
    document.querySelectorAll('.battery-segment').forEach(seg => {
      seg.addEventListener('mouseenter', () => gsap.to(seg, { y: -3, duration: 0.2 }));
      seg.addEventListener('mouseleave', () => gsap.to(seg, { y: 0, duration: 0.25 }));
    });

    document.querySelectorAll('.day-btn').forEach(btn => {
      btn.addEventListener('mouseenter', () => gsap.to(btn, { y: -2, scale: 1.03, duration: 0.2 }));
      btn.addEventListener('mouseleave', () => gsap.to(btn, { y: 0, scale: 1, duration: 0.25 }));
    });

    console.log('🔋 Recharge Week Ready!');
  });
</script>
{% endblock %}