{% extends "base.html" %}

{% block title %}E.C.H.O.E — Empathy Connection Hope Outreach Empowerment{% endblock %}

{% block styles %}
<style>
    /* Homepage-specific styles */
    main {
        padding: 0; /* Remove default padding for homepage */
    }
    
        .hero {
            padding: 44px 0 40px; /* closer to header */
            position: relative;
            overflow: hidden;
            background: rgba(255,255,255,0.75);
            border-radius: 20px;
            backdrop-filter: blur(4px);
            margin: 6px auto; /* minimal gap below header */
        }
        
        .hero .container {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .hero-content {
            max-width: 550px;
            z-index: 2;
        }
        
        .hero-content h1 {
            color: var(--deep-indigo);
            font-size: 3.2rem;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.2;
        }
        
        .hero .quote {
            font-style: italic;
            font-size: 1.2rem;
            color: var(--deep-indigo);
            opacity: 0.9;
            margin-bottom: 20px;
            padding-left: 15px;
            border-left: 3px solid var(--soft-yellow);
        }
        
        .hero .mission {
            font-size: 1.3rem;
            margin-bottom: 35px;
            color: var(--deep-indigo);
            line-height: 1.6;
        }
        
        .hero-image {
            width: 40%;
            max-width: 420px;
            z-index: 1;
        }
        
        .hero-image img {
            width: 100%;
            height: auto;
            filter: drop-shadow(0 5px 15px rgba(42, 61, 102, 0.15));
        }
        
        
    
    /* Healing Transition Styles */
    .healing-transition {
        position: relative;
        height: 200px;
        width: 100%;
        overflow: hidden;
        background: linear-gradient(
            180deg,
            rgba(232, 241, 255, 0.8) 0%,
            rgba(240, 233, 255, 0.8) 100%
        );
    }
    
    .grass-layer {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 70px;
        background: linear-gradient(
            180deg,
            rgba(168, 216, 157, 0.9) 0%,
            rgba(127, 176, 114, 0.9) 100%
        );
        border-radius: 50% 50% 0 0;
        transform: scaleX(1.2);
    }
    
    .garden-elements {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        background: radial-gradient(
            circle at 50% 100%,
            rgba(255, 255, 255, 0.3) 0%,
            transparent 70%
        );
    }
    
    .flowers-front {
        position: absolute;
        bottom: 5px;
        width: 100%;
        display: flex;
        justify-content: space-around;
        z-index: 3;
    }
    
    .flowers-middle {
        position: absolute;
        bottom: 15px;
        width: 100%;
        display: flex;
        justify-content: space-evenly;
        z-index: 2;
    }
    
    .flowers-back {
        position: absolute;
        bottom: 25px;
        width: 100%;
        display: flex;
        justify-content: space-around;
        z-index: 1;
    }
    
    .flower {
        font-size: 28px;
        opacity: 0.95;
        filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
    }
    
    .flower-small { font-size: 22px; }
    .flower-medium { font-size: 28px; }
    .flower-large { font-size: 34px; }
    
    .garden-details {
        position: absolute;
        bottom: 10px;
        width: 100%;
        display: flex;
        justify-content: space-between;
        padding: 0 5%;
        z-index: 2;
    }
    
    .garden-detail {
        font-size: 22px;
        opacity: 0.9;
    }
    
    /* Removed emoji animations; we'll render a static meadow strip */
    .cats-container { display: none; }
    
    .butterflies {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
    }
    
    .butterfly {
        position: absolute;
        font-size: 22px;
        opacity: 0.9;
        filter: drop-shadow(0 2px 3px rgba(0,0,0,0.1));
    }
    
    @keyframes butterflyPath1 {
        0% { transform: translate(0, 0) rotate(0deg); }
        33% { transform: translate(30vw, -30px) rotate(10deg); }
        66% { transform: translate(60vw, -15px) rotate(-10deg); }
        100% { transform: translate(100vw, -25px) rotate(0deg); }
    }
    
    @keyframes butterflyPath2 {
        0% { transform: translate(100vw, 0) rotate(0deg); }
        33% { transform: translate(60vw, -25px) rotate(-10deg); }
        66% { transform: translate(30vw, -15px) rotate(10deg); }
        100% { transform: translate(0, -20px) rotate(0deg); }
    }
    
    .light-rays {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle at 50% 0%,
            rgba(255, 255, 255, 0.8) 0%,
            rgba(255, 255, 255, 0.4) 25%,
            transparent 60%
        );
        animation: glowPulse 8s ease-in-out infinite;
    }
    
    @keyframes glowPulse {
        0%, 100% {
            opacity: 0.5;
            transform: scale(1);
        }
        50% {
            opacity: 0.7;
            transform: scale(1.05);
        }
    }
        
        /* (Old how-it-works removed) */
        
        /* About / Consultant / Instagram (manual) Sections */
        .about-section,
        .consultant-section,
        .social-manual {
            padding: 50px 0; /* reduce section spacing */
        }

        .about-section {
            background: linear-gradient(180deg, rgba(159,197,203,0.15) 0%, rgba(173,203,164,0.12) 100%);
            text-align: left;
        }

        .about-grid {
            display: grid;
            grid-template-columns: 1.4fr 1fr;
            gap: 40px;
            align-items: center;
        }

        .about-card {
            background: rgba(255,255,255,0.9);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(42,61,102,0.12);
        }

        .consultant-section {
            background: linear-gradient(180deg, rgba(173,203,164,0.12) 0%, rgba(159,197,203,0.12) 100%);
        }

        .consultant-card {
            display: grid;
            grid-template-columns: 96px 1fr;
            gap: 24px;
            align-items: center;
            background: rgba(255,255,255,0.92);
            border-radius: 16px;
            padding: 24px 28px;
            box-shadow: 0 10px 30px rgba(42,61,102,0.12);
        }

        .avatar {
            width: 96px;
            height: 96px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gentle-lavender), var(--soft-yellow));
            display: flex;
            align-items: center;
            justify-content: center;
            color: #0f2233;
            font-weight: 800;
            font-size: 1.4rem;
        }

        .social-manual {
            background: linear-gradient(180deg, rgba(179,156,208,0.18) 0%, rgba(159,197,203,0.18) 100%);
            text-align: center;
        }
        /* Remove built-in margins inside embeds to avoid top gaps */
        .social-manual blockquote.instagram-media,
        .social-manual blockquote.tiktok-embed{ margin:0 !important; }
        
        #community-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* force three equal columns */
            gap: 16px;
            align-items: stretch;
            width: 100%;
        }
        .post-card { width: 100%; }
        .social-manual .container { max-width: 1300px; }
        @media (max-width: 1024px) { #community-grid { grid-template-columns: 1fr; } }
        /* Equal height social cards with internal scroll */
        .post-card.social-equal { height: clamp(680px, 72vh, 860px); display: flex; }
        /* Center content when there is extra space; still scrolls when overflow */
        .post-card .card-scroll {
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center; /* center when content shorter than container */
            align-items: center;
            gap: 12px;
            padding: 8px;
            overflow-y: auto;
            overscroll-behavior: contain;
        }
        /* Left card should start content at top to avoid squeezing */
        .card-scroll-top { justify-content: flex-start; align-items: stretch; }

        .post-card {
            background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.7));
            border: 1px solid rgba(159,197,203,0.35);
            border-radius: 12px;
            overflow: hidden;
            padding: 8px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* top align */
            align-items: stretch;
        }
        /* Optional legacy helper (unused) */
        .post-card.equal-height { height: clamp(760px, 85vh, 1200px); }

        /* Center helper for the left Instagram embed */
        .embed-center { flex: 1 1 auto; display: block; }
        .social-scroll { height: 100%; overflow-y: auto; }
        .post-card a { color: var(--deep-indigo); text-decoration: none; font-weight: 700; }

        /* Uniform square grid for IG gallery thumbnails - fill full width */
        .ig-gallery {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr)); /* fixed two columns */
            column-gap: 16px; /* keep current column spacing */
            row-gap: 32px; /* 2x vertical spacing between rows */
            width: 100%;
            align-items: stretch; /* ensure rows align consistently */
            justify-items: stretch;
        }
        .ig-gallery .ig-item {
            position: relative;
            display: block; /* avoid inline gaps */
            width: 100%;
            aspect-ratio: 1 / 1; /* force squares on modern browsers */
            overflow: hidden;
            border-radius: 8px;
            background: linear-gradient(180deg, rgba(159,197,203,0.12), rgba(248,210,156,0.12));
            box-shadow: 0 6px 16px rgba(42,61,102,0.08);
        }
        .ig-gallery .ig-item img {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; /* crop to square without distortion */
        }
        /* Fallback for browsers without aspect-ratio support */
        @supports not (aspect-ratio: 1 / 1) {
            .ig-gallery .ig-item { height: auto; }
            .ig-gallery .ig-item::before { content: ''; display: block; padding-top: 100%; }
            .ig-gallery .ig-item img { position: absolute; inset: 0; }
        }

        /* Scroll container so users can scroll within the gallery card */
        #igGalleryScroll {
            /* Fill the card height so the grid starts at the top */
            height: 100%;
            max-height: none;
            overflow-y: auto;
            padding: 8px;
            overscroll-behavior: contain; /* keep page from scrolling when inside */
            min-height: 0; /* allow flex child to shrink and enable scroll */
        }
        /* Ensure the IG gallery card top-aligns content and allows the scroller to expand */
        #igGalleryCard {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
    }
    
    /* Footer styles for homepage */
        footer {
        margin-top: 0; /* Remove top margin for homepage */
        }
        
        .footer-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 40px;
        }
        
        .footer-section h3::after {
            content: '';
            position: absolute;
            width: 40px;
            height: 2px;
            background-color: var(--soft-yellow);
            bottom: 0;
            left: 0;
        }
        
        .tagline {
            font-style: italic;
            margin-bottom: 1rem;
            color: var(--soft-yellow);
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
        .hero .container {
                flex-direction: column;
            text-align: center;
            /* stack posts on small screens */
            .post-grid { grid-template-columns: 1fr; }
        }
        
        .hero-content {
            max-width: none;
            margin-bottom: 2rem;
            }
            
            .hero-content h1 {
                font-size: 2.5rem;
            }
            
            .hero .quote, .hero .mission {
                font-size: 1.1rem;
            }
            
        .hero-image {
            width: 80%;
                max-width: 400px;
            }
            
        .step-card, .card, .testimonial {
            width: 100%;
            max-width: 400px;
            }
        /* On narrow screens, let cards auto-size */
        .post-card.equal-height { height: auto; }
        }
    </style>
{% endblock %}

{% block content %}
        <section class="hero">
            <div class="container">
                <div class="hero-content">
                    <h1>Welcome to E.C.H.O.E</h1>
                    <p class="quote">Every voice deserves to be echoed.</p>
                    <p class="mission">Here, we amplify unseen voices through anonymous letters, compassionate peer replies, and inclusive events — so no one feels alone.</p>
            <a href="{{ url_for('submit') }}" class="btn-primary">Share Your Story</a>
                </div>
                <div class="hero-image">
                    <img src="{{ url_for('static', filename='img/logo.jpg') }}" alt="E.C.H.O.E" style="border-radius:16px; background: rgba(255,255,255,0.6); padding: 14px;">
                </div>
            </div>
        </section>
        
        

        
        
        
        
        <section class="about-section">
            <div class="container">
                <div class="about-grid">
                    <div class="about-card">
                        <h2 style="margin-bottom:16px;">Who We Are</h2>
                        <p style="font-size:1.1rem; line-height:1.8; color:var(--deep-indigo);">
                            We are a student-led organization committed to breaking down social isolation among teens and building a collaborative community. In a world where silence can feel heavy, we believe no one should go through their journey alone.
                        </p>
                        <p style="font-size:1.1rem; line-height:1.8; color:var(--deep-indigo);">
                            Our movement creates a bridge between solitude and belongingness. Teens can express themselves through sharing anonymous letters or messages and receive genuine, heartfelt responses from peers who care. We also share resources, insights, and guidance by holding in-person events, ensuring that support is always within reach.
                        </p>
                        <p style="font-size:1.1rem; line-height:1.8; color:var(--deep-indigo);">
                            We don’t just listen — we inspire, uplift, and help embrace new paths toward healing and resilience. Because every voice deserves to be echoed.
                        </p>
                        <p style="opacity:0.85; margin-top:10px;">Our values: Empathy • Connection • Hope • Outreach • Empowerment.</p>
                        </div>
                    <div style="text-align:center;">
                        <img src="{{ url_for('static', filename='img/logo.jpg') }}" alt="E.C.H.O.E" style="max-width:320px; width:100%; border-radius:16px; background: rgba(255,255,255,0.6); padding:14px; box-shadow:0 10px 30px rgba(42,61,102,0.12);">
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Mission / Vision / Values combined box -->
        <section class="about-section">
            <div class="container">
                <div class="about-card" style="max-width:1000px; margin:0 auto; text-align:center;">
                    <h2 style="margin-bottom:12px;">Our Mission</h2>
                    <p style="font-size:1.1rem;max-width:900px;margin:0 auto 20px;">To amplify the voices that are often unheard and stand against social isolation by creating safe, supportive spaces where teens can connect, share, and heal together.</p>
                    <h2 style="margin:12px 0;">Our Vision</h2>
                    <p style="font-size:1.1rem;max-width:900px;margin:0 auto 20px;">A world where no teen feels left out, and every voice is valued, uplifted, and celebrated. We envision a community built on empathy, collaboration, and belonging — where every voice deserves to echo.</p>
                    <h2 style="margin:12px 0;">Values</h2>
                    <ul style="list-style:none; padding:0; max-width:900px; margin:0 auto; line-height:1.8;">
                        <li><strong>Empathy</strong> — Listening with compassion and understanding.</li>
                        <li><strong>Connection</strong> — Building meaningful bonds that replace isolation with belonging.</li>
                        <li><strong>Hope</strong> — Inspiring optimism and resilience.</li>
                        <li><strong>Outreach</strong> — Extending support beyond ourselves.</li>
                        <li><strong>Empowerment</strong> — Giving every teen the confidence to share their story and embrace their voice.</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Combined How We Help + Privacy & Safety -->
        <section class="consultant-section">
            <div class="container">
                <div class="about-card">
                    <h2>How We Help</h2>
                    <ul style="margin:12px 0 18px 18px; line-height:1.8;">
                        <li>Secure online platform for anonymous sharing and human replies</li>
                        <li>Physical mailboxes in local spaces for offline letters</li>
                        <li>Supportive community events that foster belonging</li>
                    </ul>
                    <h2>Your Privacy & Safety</h2>
                    <ul style="margin:12px 0 0 18px; line-height:1.8;">
                        <li>Anonymous letters and secure storage</li>
                        <li>Volunteer training and content moderation</li>
                        <li>Clear safety guidelines to protect all users</li>
                    </ul>
                </div>
            </div>
        </section>
        
        <section class="consultant-section">
            <div class="container">
                <h2 style="text-align:center; margin-bottom:28px;">Our Mental Health Consultant</h2>
                <div class="consultant-card">
                    <div class="avatar">MH</div>
                    <div>
                        <h3 style="margin:0 0 8px;">Name: <span style="font-weight:800;">TBD</span></h3>
                        <p style="margin:0 0 6px 0; line-height:1.7;">Description: A qualified mental health professional who advises our content and safeguards supportive tone.</p>
                        <p style="margin:0; line-height:1.7; opacity:.85;">Approach: ACT/CBT, mindfulness, and strengths-based care.</p>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="about-section">
            <div class="container">
                <div class="about-card" style="max-width:900px; margin:0 auto;">
                    <h2 style="margin-bottom:12px;">Collaborators</h2>
                    <p style="margin:0 0 8px 0;">NPOs, charities, and partners we work with to extend support and outreach.</p>
                    <ul style="margin:6px 0 0 18px; line-height:1.8;">
                        <li>Coming soon — partner highlights</li>
                    </ul>
                </div>
                    </div>
        </section>
        
        <section class="social-manual">
            <div class="container">
                <h2 style="margin-bottom:18px;">From Our Community</h2>
                
                <div id="community-grid" class="post-grid">
                <!-- Left: TikTok + YouTube stacked in one scrollable box -->
                <div class="post-card social-equal">
                    <div class="card-scroll card-scroll-top">
                        <blockquote class="tiktok-embed" cite="https://www.tiktok.com/@echoe_hosa" data-unique-id="echoe_hosa" data-embed-type="creator" style="max-width: 605px;min-width: 325px;">
                          <section>Loading TikTok…</section>
                        </blockquote>
                        <div id="ytLatestHome">
                            <div style="padding:12px; text-align:center; opacity:.8; width:100%;">Loading latest YouTube video…</div>
                        </div>
                    </div>
                    <script async src="https://www.tiktok.com/embed.js"></script>
                    <script>
                    document.addEventListener('DOMContentLoaded', async function(){
                        try{
                            const r2 = await fetch('/api/youtube-latest', {cache:'no-store'});
                            const yt = await r2.json();
                            const yb = document.getElementById('ytLatestHome');
                            if(yb){
                                if(yt && yt.embed_url){
                                    yb.innerHTML = `<div class=\"embed\"><iframe width=\"100%\" height=\"315\" src=\"${yt.embed_url}\" title=\"Latest YouTube video\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe></div>`;
                                } else {
                                    yb.innerHTML = '<div class=\"embed\"><iframe width=\"100%\" height=\"315\" src=\"https://www.youtube.com/embed/0lwx3_8T7SE\" title=\"Latest YouTube video\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe></div>'
                                }
                            }
                        }catch(e){ /* ignore */ }
                    });
                    </script>
                </div>
                <!-- Middle: IG latest only -->
                <div class="post-card social-equal" id="igLatestCard">
                    <div class="card-scroll" style="display:flex;flex-direction:column;gap:12px;">
                        {% if latest_ig and latest_ig.permalink %}
                        <blockquote class="instagram-media" data-instgrm-permalink="{{ latest_ig.permalink }}" data-instgrm-captioned data-instgrm-version="14" style="background:#fff; border:0; margin:0 auto; max-width:540px; min-width:326px; width:100%;"></blockquote>
                        {% else %}
                        <div style="padding:12px; text-align:center; opacity:.8;">Latest Instagram post unavailable.</div>
                        {% endif %}
                    </div>
                    <script async src="https://www.instagram.com/embed.js"></script>
                </div>
                    <div class="post-card social-equal" id="igGalleryCard" style="display:flex;flex-direction:column;justify-content:flex-start;">
                        <div id="igGalleryScroll" class="card-scroll card-scroll-top" style="height:100%;min-height:0;padding:8px;">
                            <div id="igGallery" class="ig-gallery" style="align-items:start; min-height:110px;">
                                <!-- populated by /api/instagram-feed -->
                    </div>
                </div>
                        <script>
                        document.addEventListener('DOMContentLoaded', async function(){
                          try{
                            const r = await fetch('/api/instagram-feed', {cache:'no-store'});
                            const data = await r.json();
                            let items = (data && Array.isArray(data.items)) ? data.items : [];
                            // Deduplicate by permalink
                            const seen = new Set();
                            items = items.filter(it=>{ if(!it || !it.permalink || seen.has(it.permalink)) return false; seen.add(it.permalink); return true; });
                            const g = document.getElementById('igGallery');
                            if(!g) return;
                            g.innerHTML = '';
                            if(items.length === 0){
                              g.innerHTML = '<div style="grid-column:1/-1;opacity:.7;text-align:center;">No posts found.</div>';
                              return;
                            }
                            items.forEach(it=>{
                              const a = document.createElement('a');
                              a.href = it.permalink;
                              a.target = '_blank';
                              a.rel = 'noopener';
                              a.className = 'ig-item';
                              const img = document.createElement('img');
                              img.src = it.thumb || it.url;
                              img.alt = (it.caption||'Instagram');
                              img.loading='lazy';
                              a.appendChild(img);
                              g.appendChild(a);
                            });
                            // ensure the scroll container starts from the top after render
                            const scroller = document.getElementById('igGalleryScroll');
                            if (scroller) scroller.scrollTop = 0;
                          }catch(e){console.log('ig gallery error',e)}
                        });
                        </script>
                    </div>
                </div>
            </div>
        </section>



<script>
// Include the chat widget
document.addEventListener('DOMContentLoaded', function() {
    // Chat widget will be loaded from the base template
});
</script>
{% endblock %} 