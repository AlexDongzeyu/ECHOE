{% extends "base.html" %}

{% block title %}E.C.H.O.E — Empathy Connection Hope Outreach Empowerment{% endblock %}

{% block styles %}
<style>
    /* Homepage-specific styles */
    main {
        padding: 0; /* Remove default padding for homepage */
    }
    
        .hero {
            padding: 44px 0 40px; /* closer to header */
            position: relative;
            overflow: hidden;
            background: rgba(255,255,255,0.75);
            border-radius: 20px;
            backdrop-filter: blur(4px);
            margin: 6px auto; /* minimal gap below header */
        }
        
        .hero .container {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .hero-content {
            max-width: 600px;
            z-index: 2;
        }
        
        .hero-content h1 {
            color: var(--deep-indigo);
            font-size: 3.2rem;
            font-weight: 700;
            margin-bottom: 15px;
            line-height: 1.2;
        }
        
        .acronym-subtitle {
            font-size: 1.15rem;
            font-weight: 600;
            color: var(--gentle-lavender);
            margin-bottom: 20px;
            letter-spacing: 0.5px;
            white-space: nowrap;
            overflow-x: auto;
        }
        
        .acronym-subtitle span {
            display: inline-block;
        }
        
        .acronym-letter {
            color: var(--soft-yellow);
            font-weight: 700;
            font-size: 1.25rem;
        }
        
        .acronym-word {
            color: var(--deep-indigo);
        }
        
        .acronym-dot {
            color: var(--gentle-lavender);
            opacity: 0.5;
        }
        
        .hero .quote {
            font-style: italic;
            font-size: 1.2rem;
            color: var(--deep-indigo);
            opacity: 0.9;
            margin-bottom: 20px;
            padding-left: 15px;
            border-left: 3px solid var(--soft-yellow);
        }
        
        .hero .mission {
            font-size: 1.3rem;
            margin-bottom: 35px;
            color: var(--deep-indigo);
            line-height: 1.6;
        }
        
        .hero-image {
            width: 40%;
            max-width: 420px;
            z-index: 1;
        }
        
        .hero-image img {
            width: 100%;
            height: auto;
            filter: drop-shadow(0 5px 15px rgba(42, 61, 102, 0.15));
        }
        
        
    
    /* Healing Transition Styles */
    .healing-transition {
        position: relative;
        height: 200px;
        width: 100%;
        overflow: hidden;
        background: linear-gradient(
            180deg,
            rgba(232, 241, 255, 0.8) 0%,
            rgba(240, 233, 255, 0.8) 100%
        );
    }
    
    .grass-layer {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 70px;
        background: linear-gradient(
            180deg,
            rgba(168, 216, 157, 0.9) 0%,
            rgba(127, 176, 114, 0.9) 100%
        );
        border-radius: 50% 50% 0 0;
        transform: scaleX(1.2);
    }
    
    .garden-elements {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        background: radial-gradient(
            circle at 50% 100%,
            rgba(255, 255, 255, 0.3) 0%,
            transparent 70%
        );
    }
    
    .flowers-front {
        position: absolute;
        bottom: 5px;
        width: 100%;
        display: flex;
        justify-content: space-around;
        z-index: 3;
    }
    
    .flowers-middle {
        position: absolute;
        bottom: 15px;
        width: 100%;
        display: flex;
        justify-content: space-evenly;
        z-index: 2;
    }
    
    .flowers-back {
        position: absolute;
        bottom: 25px;
        width: 100%;
        display: flex;
        justify-content: space-around;
        z-index: 1;
    }
    
    .flower {
        font-size: 28px;
        opacity: 0.95;
        filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
    }
    
    .flower-small { font-size: 22px; }
    .flower-medium { font-size: 28px; }
    .flower-large { font-size: 34px; }
    
    .garden-details {
        position: absolute;
        bottom: 10px;
        width: 100%;
        display: flex;
        justify-content: space-between;
        padding: 0 5%;
        z-index: 2;
    }
    
    .garden-detail {
        font-size: 22px;
        opacity: 0.9;
    }
    
    /* Removed emoji animations; we'll render a static meadow strip */
    .cats-container { display: none; }
    
    .butterflies {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
    }
    
    .butterfly {
        position: absolute;
        font-size: 22px;
        opacity: 0.9;
        filter: drop-shadow(0 2px 3px rgba(0,0,0,0.1));
    }
    
    @keyframes butterflyPath1 {
        0% { transform: translate(0, 0) rotate(0deg); }
        33% { transform: translate(30vw, -30px) rotate(10deg); }
        66% { transform: translate(60vw, -15px) rotate(-10deg); }
        100% { transform: translate(100vw, -25px) rotate(0deg); }
    }
    
    @keyframes butterflyPath2 {
        0% { transform: translate(100vw, 0) rotate(0deg); }
        33% { transform: translate(60vw, -25px) rotate(-10deg); }
        66% { transform: translate(30vw, -15px) rotate(10deg); }
        100% { transform: translate(0, -20px) rotate(0deg); }
    }
    
    .light-rays {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle at 50% 0%,
            rgba(255, 255, 255, 0.8) 0%,
            rgba(255, 255, 255, 0.4) 25%,
            transparent 60%
        );
        animation: glowPulse 8s ease-in-out infinite;
    }
    
    @keyframes glowPulse {
        0%, 100% {
            opacity: 0.5;
            transform: scale(1);
        }
        50% {
            opacity: 0.7;
            transform: scale(1.05);
        }
    }
        
        /* (Old how-it-works removed) */
        
        /* About / Consultant / Instagram (manual) Sections */
        .about-section,
        .consultant-section,
        .social-manual {
            padding: 36px 0; /* tighter section spacing */
        }

        .about-section {
            background: linear-gradient(180deg, rgba(159,197,203,0.15) 0%, rgba(173,203,164,0.12) 100%);
            text-align: left;
        }

        .about-grid {
            display: grid;
            grid-template-columns: 1.4fr 1fr;
            gap: 24px;
            align-items: center;
        }

        .about-card {
            background: rgba(255,255,255,0.9);
            border-radius: 16px;
            padding: 24px; /* tighter card padding */
            box-shadow: 0 10px 30px rgba(42,61,102,0.12);
        }
        /* Generic two-column grid for paired sections */
        .two-col-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            align-items: stretch; /* make children equal height */
        }
        /* Wider left column specifically for partners block */
        .partners-grid { grid-template-columns: 1.4fr 1fr; }
        .two-col-grid .about-card { height: 100%; display: flex; flex-direction: column; }

        .consultant-section {
            background: linear-gradient(180deg, rgba(173,203,164,0.12) 0%, rgba(159,197,203,0.12) 100%);
        }

        .consultant-card {
            display: grid;
            grid-template-columns: 260px 1fr;
            gap: 28px;
            align-items: center;
            background: rgba(255,255,255,0.92);
            border-radius: 16px;
            padding: 24px 28px;
            box-shadow: 0 10px 30px rgba(42,61,102,0.12);
        }

        .avatar {
            width: 96px;
            height: 96px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gentle-lavender), var(--soft-yellow));
            display: flex;
            align-items: center;
            justify-content: center;
            color: #0f2233;
            font-weight: 800;
            font-size: 1.4rem;
        }
        .avatar-photo { width:100%; height:auto; border-radius:14px; object-fit:contain; object-position:center; box-shadow:0 6px 18px rgba(42,61,102,0.12); }

        .social-manual {
            background: linear-gradient(180deg, rgba(179,156,208,0.18) 0%, rgba(159,197,203,0.18) 100%);
            text-align: center;
        }
        /* Remove built-in margins inside embeds to avoid top gaps */
        .social-manual blockquote.instagram-media,
        .social-manual blockquote.tiktok-embed{ margin:0 !important; }
        
        #community-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* force three equal columns */
            gap: 12px; /* tighter spacing between frames */
            align-items: stretch;
            width: 100%;
        }
        .post-card { width: 100%; }
        .social-manual .container { max-width: 1300px; }
        @media (max-width: 1024px) { #community-grid { grid-template-columns: 1fr; } }
        /* Equal height social cards with internal scroll (reduced excess space) */
        .post-card.social-equal { height: clamp(700px, 78vh, 900px); display: flex; }
        /* Center content when there is extra space; still scrolls when overflow */
        .post-card .card-scroll {
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* top align to remove large blanks */
            align-items: stretch;
            gap: 12px;
            padding: 6px;
            overflow-y: auto;
            overscroll-behavior: contain;
        }
        /* Ensure top-aligned content in all cards */
        .card-scroll-top { justify-content: flex-start; align-items: stretch; }

        .post-card {
            background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.7));
            border: 1px solid rgba(159,197,203,0.35);
            border-radius: 12px;
            overflow: hidden;
            padding: 8px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* top align */
            align-items: stretch;
        }
        /* Optional legacy helper (unused) */
        .post-card.equal-height { height: clamp(760px, 85vh, 1200px); }

        /* Center helper for the left Instagram embed */
        .embed-center { flex: 1 1 auto; display: block; }
        .social-scroll { height: 100%; overflow-y: auto; }
        .post-card a { color: var(--deep-indigo); text-decoration: none; font-weight: 700; }

        /* IG gallery - two columns, full posts (no crop), scroll within frame */
        .ig-gallery {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 12px; /* base gap = column gap */
            row-gap: 0; /* use margin on items for vertical spacing (Edge-safe) */
            column-gap: 12px; /* tighter column spacing */
            grid-row-gap: 0; /* legacy */
            grid-column-gap: 12px; /* Safari legacy horizontal */
            width: 100%;
            align-items: start; /* let each item size to its content height */
            justify-items: stretch;
            padding-bottom: 2px; /* prevent visual crowding at bottom edge */
            grid-auto-rows: auto; /* ensure rows grow to content */
        }
        .ig-gallery .ig-item {
            position: relative;
            display: block;
            width: 100%;
            overflow: hidden; /* keep rounded corners */
            border-radius: 14px; /* keep rounded corners */
            background: transparent; /* no surrounding frame */
            box-shadow: 0 6px 16px rgba(42,61,102,0.08);
            margin: 0 0 45px 0; /* explicit vertical spacing between rows */
            padding: 0; /* remove inner frame */
            box-sizing: border-box;
        }
        .ig-gallery .ig-item img {
            position: static;
            display: block;
            width: 100% !important;
            height: auto !important; /* keep full image visible */
            max-height: none !important;
            object-fit: contain !important;
            object-position: center center;
        }
        @media (max-width: 640px) {
            .ig-gallery { grid-template-columns: 1fr; }
        }

        /* Scroll container so users can scroll within the gallery card */
        #igGalleryScroll {
            /* Fill the card height so the grid starts at the top */
            height: 100%;
            max-height: none;
            overflow-y: auto;
            padding: 6px;
            overscroll-behavior: contain; /* keep page from scrolling when inside */
            min-height: 0; /* allow flex child to shrink and enable scroll */
        }
        /* Ensure the IG gallery card top-aligns content and allows the scroller to expand */
        #igGalleryCard {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
    }
    
    /* Footer styles for homepage */
        footer {
        margin-top: 0; /* Remove top margin for homepage */
        }
        
        .footer-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 40px;
        }
        
        .footer-section h3::after {
            content: '';
            position: absolute;
            width: 40px;
            height: 2px;
            background-color: var(--soft-yellow);
            bottom: 0;
            left: 0;
        }
        
        .tagline {
            font-style: italic;
            margin-bottom: 1rem;
            color: var(--soft-yellow);
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
        .hero .container {
                flex-direction: column;
            text-align: center;
            /* stack posts on small screens */
            .post-grid { grid-template-columns: 1fr; }
        /* Shrink consultant photo on small screens */
        .consultant-card { grid-template-columns: 180px 1fr; gap: 20px; }
        .avatar-photo { width:100%; height:auto; border-radius:12px; object-fit:contain; object-position:center; }
        }
        
        .hero-content {
            max-width: none;
            margin-bottom: 2rem;
            }
            
            .hero-content h1 {
                font-size: 2.5rem;
            }
            
            .acronym-subtitle {
                font-size: 0.95rem;
                overflow-x: auto;
                white-space: nowrap;
            }
            
            .acronym-letter {
                font-size: 1.05rem;
            }
            
            .hero .quote, .hero .mission {
                font-size: 1.1rem;
            }
            
        .hero-image {
            width: 80%;
                max-width: 400px;
            }
            
        .step-card, .card, .testimonial {
            width: 100%;
            max-width: 400px;
            }
        /* On narrow screens, let cards auto-size */
        .post-card.equal-height { height: auto; }
        .two-col-grid { grid-template-columns: 1fr; }
        }
    </style>
{% endblock %}

{% block content %}
        <section class="hero">
            <div class="container">
                <div class="hero-content">
                    <h1>Welcome to E.C.H.O.E</h1>
                    <div class="acronym-subtitle">
                        <span><span class="acronym-letter">E</span><span class="acronym-word">mpathy</span></span>
                        <span class="acronym-dot">•</span>
                        <span><span class="acronym-letter">C</span><span class="acronym-word">onnection</span></span>
                        <span class="acronym-dot">•</span>
                        <span><span class="acronym-letter">H</span><span class="acronym-word">ope</span></span>
                        <span class="acronym-dot">•</span>
                        <span><span class="acronym-letter">O</span><span class="acronym-word">utreach</span></span>
                        <span class="acronym-dot">•</span>
                        <span><span class="acronym-letter">E</span><span class="acronym-word">mpowerment</span></span>
                    </div>
                    <p class="quote">Every voice deserves to echo — from the shadows of silence, we rise together.</p>
                    <p class="mission">Here, we amplify unseen voices through anonymous letters, compassionate peer replies, and inclusive events — so no one feels alone.</p>
            <a href="{{ url_for('submit') }}" class="btn-primary">Share Your Story</a>
                </div>
                <div class="hero-image">
                    <img src="{{ url_for('static', filename='img/logo.jpg') }}" alt="E.C.H.O.E" style="border-radius:16px; background: rgba(255,255,255,0.6); padding: 14px;">
                </div>
            </div>
        </section>
        
        

        
        
        
        
        <section class="about-section">
            <div class="container">
                <div class="about-grid">
                    <div class="about-card">
                        <h2 style="margin-bottom:16px;">Who We Are</h2>
                        <p style="font-size:1.05rem; font-style:italic; color:var(--deep-indigo); opacity:0.9; margin-bottom:16px; border-left:3px solid var(--soft-yellow); padding-left:16px;">
                            Where loneliness ends, empathy begins.
                        </p>
                        <p style="font-size:1.1rem; line-height:1.8; color:var(--deep-indigo);">
                            We are a student-led organization committed to breaking down social isolation among teens and building a collaborative community. In a world where silence can feel heavy, we believe no one should go through their journey alone.
                        </p>
                        <p style="font-size:1.1rem; line-height:1.8; color:var(--deep-indigo);">
                            Our movement creates a bridge between solitude and belongingness. Teens can express themselves through sharing anonymous letters or messages and receive genuine, heartfelt responses from peers who care. We also share resources, insights, and guidance by holding in-person events, ensuring that support is always within reach.
                        </p>
                        <p style="font-size:1.1rem; line-height:1.8; color:var(--deep-indigo);">
                            We don’t just listen — we inspire, uplift, and help embrace new paths toward healing and resilience. Because every voice deserves to be echoed.
                        </p>
                        <p style="opacity:0.85; margin-top:10px;">Our values: Empathy • Connection • Hope • Outreach • Empowerment.</p>
                        </div>
                    <div style="text-align:center;">
                        <img src="{{ url_for('static', filename='img/logo.jpg') }}" alt="E.C.H.O.E" style="max-width:320px; width:100%; border-radius:16px; background: rgba(255,255,255,0.6); padding:14px; box-shadow:0 10px 30px rgba(42,61,102,0.12);">
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Mission/Vision/Values and How We Help side by side -->
        <section class="about-section">
            <div class="container">
                <h2 style="text-align:center; margin-bottom:18px;">About Us</h2>
                <div class="two-col-grid">
                    <div class="about-card" style="text-align:center;">
                        <h2 style="margin-bottom:10px;">Our Mission</h2>
                        <p style="font-size:1.05rem; margin:0 0 16px;">To amplify the voices that are often unheard and stand against social isolation by creating safe, supportive spaces where teens can connect, share, and heal together.</p>
                        <h2 style="margin:10px 0;">Our Vision</h2>
                        <p style="font-size:1.05rem; margin:0 0 16px;">A world where no teen feels left out, and every voice is valued, uplifted, and celebrated. We envision a community built on empathy, collaboration, and belonging — where every voice deserves to echo.</p>
                        <h2 style="margin:10px 0;">Values</h2>
                        <ul style="list-style:none; padding:0; margin:0; line-height:1.7; text-align:left;">
                            <li><strong>Empathy</strong> — Listening with compassion and understanding.</li>
                            <li><strong>Connection</strong> — Building meaningful bonds that replace isolation with belonging.</li>
                            <li><strong>Hope</strong> — Inspiring optimism and resilience.</li>
                            <li><strong>Outreach</strong> — Extending support beyond ourselves.</li>
                            <li><strong>Empowerment</strong> — Giving every teen the confidence to share their story and embrace their voice.</li>
                        </ul>
                    </div>
                    <div class="about-card">
                        <h2>How We Help</h2>
                        <ul style="margin:8px 0 0 18px; line-height:1.7;">
                            <li>Secure online platform for anonymous sharing and human replies</li>
                            <li>Physical mailboxes in local spaces for offline letters</li>
                            <li>Supportive community events that foster belonging</li>
                        </ul>
                        <h2 style="margin-top:16px;">Your Privacy & Safety</h2>
                        <ul style="margin:8px 0 0 18px; line-height:1.7;">
                            <li>Anonymous letters and secure storage</li>
                            <li>Volunteer training and content moderation</li>
                            <li>Clear safety guidelines to protect all users</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        
        
        <section class="about-section">
            <div class="container">
                <h2 style="text-align:center; margin-bottom:18px;">Our Partners</h2>
                <div class="two-col-grid partners-grid">
                    <div class="about-card">
                        <h2 style="margin-bottom:10px;">Our Mental Health Consultant</h2>
                        <div class="consultant-card" style="box-shadow:none; padding:0; background:transparent;">
                            <img src="{{ url_for('static', filename='img/unnamed.jpg') }}" alt="Leora Raphael-Berman" class="avatar-photo">
                            <div>
                                <p style="margin:0 0 8px 0; line-height:1.7; font-weight:800; color:var(--deep-indigo);">Leora Raphael-Berman, RN</p>
                                <p style="margin:0; line-height:1.75; opacity:.9;">
                                    Leora Raphael-Berman is a Registered Nurse with over a decade of experience in public and community health. She is deeply passionate about mental health and empowering young people to care for their well-being and support one another. Alongside her clinical and community work, she has proudly served as the staff lead for her school’s JACK chapter for the past three years. This year, she is excited to support the HOSA team as the Mental Health Consultant, helping students build a project that promotes awareness, empathy, and meaningful conversations about mental wellness.
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="about-card">
                        <h2 style="margin-bottom:10px;">Collaborators</h2>
                        <div style="display:flex; align-items:center; gap:16px; flex-wrap:wrap;">
                            <div style="text-align:center;">
                                <img src="{{ url_for('static', filename='img/36772216_229088281046822_4982479371248861184_n.jpg') }}" alt="Gifted People Services" style="max-width:220px; width:100%; border-radius:12px; box-shadow:0 6px 20px rgba(42,61,102,0.1);">
                                <p style="margin-top:8px; font-weight:700; color:var(--deep-indigo);">Gifted People Services</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="social-manual">
            <div class="container">
                <h2 style="margin-bottom:18px;">From Our Community</h2>
                
                <div id="community-grid" class="post-grid">
                <!-- Left: TikTok + YouTube stacked in one scrollable box -->
                <div class="post-card social-equal">
                    <div class="card-scroll card-scroll-top">
                        <blockquote class="tiktok-embed" cite="https://www.tiktok.com/@echoe_hosa" data-unique-id="echoe_hosa" data-embed-type="creator" style="max-width: 605px;min-width: 325px;">
                          <section>Loading TikTok…</section>
                        </blockquote>
                        <div id="ytLatestHome">
                            <div style="padding:12px; text-align:center; opacity:.8; width:100%;">Loading latest YouTube video…</div>
                        </div>
                    </div>
                    <script async src="https://www.tiktok.com/embed.js"></script>
                    <script>
                    document.addEventListener('DOMContentLoaded', async function(){
                        try{
                            const r2 = await fetch('/api/youtube-latest', {cache:'no-store'});
                            const yt = await r2.json();
                            const yb = document.getElementById('ytLatestHome');
                            if(yb){
                                if(yt && yt.embed_url){
                                    yb.innerHTML = `<div class=\"embed\"><iframe width=\"100%\" height=\"315\" src=\"${yt.embed_url}\" title=\"Latest YouTube video\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe></div>`;
                                } else {
                                    yb.innerHTML = '<div class=\"embed\"><iframe width=\"100%\" height=\"315\" src=\"https://www.youtube.com/embed/0lwx3_8T7SE\" title=\"Latest YouTube video\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe></div>'
                                }
                            }
                        }catch(e){ /* ignore */ }
                    });
                    </script>
                </div>
                <!-- Middle: IG latest only -->
                <div class="post-card social-equal" id="igLatestCard">
                    <div class="card-scroll" style="display:flex;flex-direction:column;gap:12px;">
                        {% if latest_ig and latest_ig.permalink %}
                        <blockquote class="instagram-media" data-instgrm-permalink="{{ latest_ig.permalink }}" data-instgrm-captioned data-instgrm-version="14" style="background:#fff; border:0; margin:0 auto; max-width:540px; min-width:326px; width:100%;"></blockquote>
                        {% else %}
                        <div style="padding:12px; text-align:center; opacity:.8;">Latest Instagram post unavailable.</div>
                        {% endif %}
                    </div>
                    <script async src="https://www.instagram.com/embed.js"></script>
                </div>
                    <div class="post-card social-equal" id="igGalleryCard" style="display:flex;flex-direction:column;justify-content:flex-start;">
                        <div id="igGalleryScroll" class="card-scroll card-scroll-top" style="height:100%;min-height:0;padding:8px;">
                            <div id="igGallery" class="ig-gallery" style="min-height:110px;">
                                <!-- populated by /api/instagram-feed -->
                    </div>
                </div>
                        <script>
                        document.addEventListener('DOMContentLoaded', async function(){
                          try{
                            const r = await fetch('/api/instagram-feed', {cache:'no-store'});
                            const data = await r.json();
                            let items = (data && Array.isArray(data.items)) ? data.items : [];
                            // Deduplicate by permalink
                            const seen = new Set();
                            items = items.filter(it=>{ if(!it || !it.permalink || seen.has(it.permalink)) return false; seen.add(it.permalink); return true; });
                            const g = document.getElementById('igGallery');
                            if(!g) return;
                            g.innerHTML = '';
                            if(items.length === 0){
                              g.innerHTML = '<div style="grid-column:1/-1;opacity:.7;text-align:center;">No posts found.</div>';
                              return;
                            }
                            items.forEach(it=>{
                              const a = document.createElement('a');
                              a.href = it.permalink;
                              a.target = '_blank';
                              a.rel = 'noopener';
                              a.className = 'ig-item';
                              const img = document.createElement('img');
                              img.src = it.thumb || it.url;
                              img.alt = (it.caption||'Instagram');
                              img.loading='lazy';
                              a.appendChild(img);
                              g.appendChild(a);
                            });
                            // ensure the scroll container starts from the top after render
                            const scroller = document.getElementById('igGalleryScroll');
                            if (scroller) scroller.scrollTop = 0;
                          }catch(e){console.log('ig gallery error',e)}
                        });
                        </script>
                    </div>
                </div>
            </div>
        </section>



<script>
// Include the chat widget
document.addEventListener('DOMContentLoaded', function() {
    // Chat widget will be loaded from the base template
});
</script>
{% endblock %} 