<!DOCTYPE html>
<html lang="en-CA">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Moderation - Light in Silence</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --deep-indigo: #2A3D66;
            --soft-yellow: #F4D06F;
            --warm-white: #FAFAFA;
            --gentle-lavender: #B39CD0;
            --light-yellow: #f8e2a0;
            --danger-red: #ff5722;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            line-height: 1.6;
            color: var(--deep-indigo);
            background: linear-gradient(135deg, var(--warm-white), rgba(179, 156, 208, 0.1));
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        header {
            background-color: var(--deep-indigo);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 0.3rem 0;
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--warm-white);
            text-decoration: none;
            display: flex;
            align-items: center;
            transition: transform 0.3s ease;
        }
        
        .logo:hover { transform: scale(1.05); }
        
        .logo-img {
            height: 32px;
            width: 32px;
            margin-right: 10px;
            background-color: var(--soft-yellow);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--deep-indigo);
        }
        
        nav ul {
            display: flex;
            list-style: none;
            align-items: center;
            gap: 1.5rem;
        }
        
        nav ul li a {
            color: var(--warm-white);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            padding: 0.5rem 1rem;
            border-radius: 8px;
        }
        
        nav ul li a:hover {
            background-color: rgba(244, 208, 111, 0.2);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
        }

        .admin-header {
            background: linear-gradient(135deg, var(--danger-red), #d84315);
            border-radius: 25px;
            padding: 50px 40px;
            margin-bottom: 40px;
            text-align: center;
            color: white;
        }

        .admin-header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }

        .admin-tabs {
            display: flex;
            background: white;
            border-radius: 20px;
            padding: 8px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(42, 61, 102, 0.1);
            overflow-x: auto;
            gap: 5px;
            flex-wrap: wrap;
        }
        
        .nav-tab {
            flex: 1;
            padding: 18px 25px;
            background: transparent;
            border: none;
            border-radius: 15px;
            color: var(--deep-indigo);
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-decoration: none;
            min-width: 160px;
        }
        
        .nav-tab:hover:not(.active) {
            background: var(--gentle-lavender);
            color: white;
            transform: translateY(-2px);
        }
        
        .nav-tab.active {
            background: var(--deep-indigo);
            color: white;
            box-shadow: 0 5px 15px rgba(42, 61, 102, 0.3);
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(42, 61, 102, 0.08);
            border-left: 5px solid var(--danger-red);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--deep-indigo);
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(42, 61, 102, 0.08);
        }

        .section h2 {
            font-size: 1.8rem;
            color: var(--deep-indigo);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .content-item {
            background: #fafafa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid var(--danger-red);
            transition: all 0.3s ease;
        }

        .content-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(42, 61, 102, 0.15);
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .content-type {
            background: var(--danger-red);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .content-date {
            color: #666;
            font-size: 0.9rem;
        }

        .content-text {
            color: var(--deep-indigo);
            margin-bottom: 20px;
            line-height: 1.6;
            padding: 15px;
            background: white;
            border-radius: 10px;
        }

        .flag-reason {
            background: #fff3e0;
            color: #f57c00;
            padding: 10px 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            font-weight: 600;
            border-left: 4px solid #ff9800;
        }

        .content-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .btn-approve {
            background: #4caf50;
            color: white;
        }

        .btn-approve:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .btn-delete {
            background: var(--danger-red);
            color: white;
        }

        .btn-delete:hover {
            background: #e64a19;
            transform: translateY(-2px);
        }

        .btn-warn {
            background: #ff9800;
            color: white;
        }

        .btn-warn:hover {
            background: #f57c00;
            transform: translateY(-2px);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.3;
            color: var(--gentle-lavender);
        }

        footer {
            background-color: var(--deep-indigo);
            color: var(--warm-white);
            padding: 2rem;
            text-align: center;
            margin-top: auto;
        }

        @media (max-width: 768px) {
            nav {
                flex-direction: column;
                padding: 0.8rem 1rem;
            }
            
            nav ul {
                margin-top: 1rem;
                flex-wrap: wrap;
                justify-content: center;
                gap: 1rem;
            }

            .container {
                padding: 15px;
            }

            .admin-header h1 {
                font-size: 2.5rem;
                flex-direction: column;
                gap: 10px;
            }

            .admin-tabs {
                flex-direction: column;
                gap: 8px;
            }

            .stats-row {
                grid-template-columns: 1fr;
            }

            .content-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <a href="index.html" class="logo">
                <div class="logo-img">
                    <i class="fas fa-heart"></i>
                </div>
                <span>Light in Silence</span>
            </a>
            
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="admin-dashboard.html">Admin</a></li>
                <li><a href="volunteer-dashboard.html">Volunteer</a></li>
                <li><a href="user-management.html" id="userManagementLink" style="display: none;">Users</a></li>
                <li><a href="submit.html">Share Your Story</a></li>
                <li><a href="check-reply.html">Check Reply</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="resources.html">Resources</a></li>
                <li><a href="#" onclick="logout()">Logout</a></li>
            </ul>
        </nav>
    </header>
    
    <main>
        <div class="container">
            <!-- Header -->
            <div class="admin-header">
                <h1>
                    <i class="fas fa-shield-alt"></i>
                    Content Moderation
                </h1>
                <p>Review flagged content and maintain community standards</p>
            </div>
            
            <!-- Navigation Tabs -->
            <div class="admin-tabs">
                <a href="admin-dashboard.html" class="nav-tab">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                
                <a href="user-management.html" class="nav-tab" id="userManagementTab" style="display: none;">
                    <i class="fas fa-users"></i>
                    <span>Manage Users</span>
                </a>
                
                <a href="content-moderation.html" class="nav-tab active">
                    <i class="fas fa-file-alt"></i>
                    <span>Content</span>
                </a>
                
                <a href="volunteer-dashboard.html" class="nav-tab">
                    <i class="fas fa-heart"></i>
                    <span>Volunteer</span>
                </a>
                
                <a href="index.html" class="nav-tab">
                    <i class="fas fa-home"></i>
                    <span>Website</span>
                </a>
            </div>

            <!-- Statistics -->
            <div class="stats-row">
                <div class="stat-card">
                    <div class="stat-number" id="flaggedCount">0</div>
                    <div class="stat-label">Flagged Content</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="reviewedToday">0</div>
                    <div class="stat-label">Reviewed Today</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalReviewed">0</div>
                    <div class="stat-label">Total Reviewed</div>
                </div>
            </div>

            <!-- Flagged Letters Section -->
            <div class="section">
                <h2>
                    <i class="fas fa-flag"></i>
                    Flagged Letters
                </h2>
                <div id="flaggedContent">
                    <!-- Flagged content will be loaded here -->
                </div>
            </div>
        </div>
    </main>
    
    <footer>
        <div style="max-width: 1200px; margin: 0 auto;">
            <p>&copy; 2025 Light in Silence. All rights reserved. | Where Your Words Find Light</p>
            <p style="margin-top: 0.5rem;">
                Content moderation to maintain safe community spaces.
            </p>
        </div>
    </footer>

    <script>
        // Demo flagged content
        const flaggedContent = [
            {
                id: 'flag-001',
                type: 'Letter',
                content: 'I don\'t see the point in continuing anymore. Everything feels hopeless and I just want the pain to stop. Sometimes I think about ending it all...',
                reason: 'Contains suicide ideation keywords',
                flaggedAt: '2025-01-08 15:30',
                severity: 'high'
            },
            {
                id: 'flag-002',
                type: 'Letter',
                content: 'My roommate is such an idiot and I hate living with them. They leave their stuff everywhere and never clean up. I want to hurt them sometimes...',
                reason: 'Contains potential violence indicators',
                flaggedAt: '2025-01-08 12:15',
                severity: 'medium'
            },
            {
                id: 'flag-003',
                type: 'Letter',
                content: 'I\'ve been having really dark thoughts lately and I don\'t know what to do. My family doesn\'t understand and I feel completely alone...',
                reason: 'Mental health crisis indicators',
                flaggedAt: '2025-01-07 18:45',
                severity: 'high'
            }
        ];

        let currentUser = null;

        // Check authentication and role access
        function checkAuth() {
            const userSession = localStorage.getItem('lightInSilenceUser');
            if (!userSession) {
                window.location.href = 'login.html';
                return;
            }

            try {
                const session = JSON.parse(userSession);
                if (session.userType !== 'admin') {
                    alert('Access denied. Admin privileges required.');
                    window.location.href = 'login.html';
                    return;
                }

                currentUser = session;
                
                // Show ultimate admin features for specific accounts
                if (session.email === 'admin@lightinsilence.org' || session.email === 'admin@demo.com') {
                    document.getElementById('userManagementTab').style.display = 'flex';
                    document.getElementById('userManagementLink').style.display = 'block';
                }
                
            } catch (e) {
                localStorage.removeItem('lightInSilenceUser');
                window.location.href = 'login.html';
            }
        }

        // Load flagged content
        function loadFlaggedContent() {
            const container = document.getElementById('flaggedContent');
            
            // Update statistics
            document.getElementById('flaggedCount').textContent = flaggedContent.length;
            document.getElementById('reviewedToday').textContent = Math.floor(Math.random() * 10) + 3;
            document.getElementById('totalReviewed').textContent = Math.floor(Math.random() * 100) + 45;

            if (flaggedContent.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-check-circle"></i>
                        <h3>No Flagged Content</h3>
                        <p>All content has been reviewed. Great work maintaining community standards!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = flaggedContent.map(item => createContentItem(item)).join('');
        }

        // Create content item HTML
        function createContentItem(item) {
            const formattedDate = new Date(item.flaggedAt).toLocaleDateString('en-CA', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });

            const severityColor = item.severity === 'high' ? '#f44336' : 
                                 item.severity === 'medium' ? '#ff9800' : '#4caf50';

            return `
                <div class="content-item" style="border-left-color: ${severityColor};">
                    <div class="content-header">
                        <span class="content-type" style="background: ${severityColor};">
                            ${item.type} - ${item.severity.toUpperCase()} PRIORITY
                        </span>
                        <span class="content-date">${formattedDate}</span>
                    </div>
                    
                    <div class="flag-reason">
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>Flag Reason:</strong> ${item.reason}
                    </div>
                    
                    <div class="content-text">
                        ${item.content}
                    </div>
                    
                    <div class="content-actions">
                        <button class="btn btn-approve" onclick="approveContent('${item.id}')">
                            <i class="fas fa-check"></i>
                            Approve Content
                        </button>
                        <button class="btn btn-warn" onclick="sendWarning('${item.id}')">
                            <i class="fas fa-exclamation"></i>
                            Send Warning
                        </button>
                        <button class="btn btn-delete" onclick="removeContent('${item.id}')">
                            <i class="fas fa-trash"></i>
                            Remove Content
                        </button>
                        ${item.severity === 'high' ? `
                            <button class="btn btn-warn" onclick="triggerCrisisResponse('${item.id}')">
                                <i class="fas fa-phone"></i>
                                Crisis Response
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        // Content moderation actions
        function approveContent(itemId) {
            const itemIndex = flaggedContent.findIndex(item => item.id === itemId);
            if (itemIndex !== -1) {
                flaggedContent.splice(itemIndex, 1);
                loadFlaggedContent();
                showNotification('Content approved and unflagged.', 'success');
            }
        }

        function sendWarning(itemId) {
            const itemIndex = flaggedContent.findIndex(item => item.id === itemId);
            if (itemIndex !== -1) {
                flaggedContent.splice(itemIndex, 1);
                loadFlaggedContent();
                showNotification('Warning sent to user. Content has been reviewed.', 'warning');
            }
        }

        function removeContent(itemId) {
            if (confirm('Are you sure you want to permanently remove this content? This action cannot be undone.')) {
                const itemIndex = flaggedContent.findIndex(item => item.id === itemId);
                if (itemIndex !== -1) {
                    flaggedContent.splice(itemIndex, 1);
                    loadFlaggedContent();
                    showNotification('Content has been permanently removed.', 'error');
                }
            }
        }

        function triggerCrisisResponse(itemId) {
            if (confirm('This will initiate crisis response protocols. Continue?')) {
                showNotification('Crisis response team has been notified. Emergency resources will be provided to the user.', 'success');
                // Remove from queue as it's now being handled by crisis team
                const itemIndex = flaggedContent.findIndex(item => item.id === itemId);
                if (itemIndex !== -1) {
                    flaggedContent.splice(itemIndex, 1);
                    loadFlaggedContent();
                }
            }
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const colors = {
                success: '#4caf50',
                error: '#f44336',
                warning: '#ff9800',
                info: '#2196f3'
            };

            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${colors[type]};
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.2);
                z-index: 1000;
                font-weight: 600;
                max-width: 350px;
                line-height: 1.4;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // Logout function
        function logout() {
            localStorage.removeItem('lightInSilenceUser');
            window.location.href = 'login.html';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            checkAuth();
            loadFlaggedContent();
        });
    </script>
</body>
</html> 